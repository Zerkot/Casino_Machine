<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Solde de la Machine √† Sous</title>

  <style>
    #balance-container {
      position: fixed;
      top: 20px;
      right: 20px;
      background-color: #007bff;
      color: white;
      padding: 10px 15px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      font-size: 1.5em;
      font-weight: bold;
      font-family: Arial, sans-serif;
      z-index: 1000;
    }
    #balance-container button {
      margin-left: 10px;
      font-size: 0.7em;
      padding: 5px 8px;
      vertical-align: middle;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      color: #333;
    }
    #rules-button { background-color: #17a2b8; color: white; font-weight: bold; }
    #rules-button:hover { background-color: #117a8b; }
    #cheat-button { background-color: #888; color: white; }
    #cheat-button:hover { background-color: #666; }
    #test-button { background-color: #f39c12; color: white; display: none; }
    #test-button:hover { background-color: #e67e22; }

    #spin-button {
      position: fixed;
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #007bff;
      color: white;
      font-size: 2.5em;
      font-weight: bold;
      padding: 20px 50px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
      z-index: 1000;
      transition: background-color 0.2s, transform 0.1s;
    }
    #spin-button:hover { background-color: #0056b3; }
    #spin-button:active { transform: translateX(-50%) scale(0.95); }
    #spin-button:disabled { background-color: #555; cursor: not-allowed; box-shadow: none; transform: translateX(-50%); }

    #slot-container {
      width: 90%;
      max-width: 600px;
      margin: 80px auto 0 auto;
      background: #2c3e50;
      border: 10px solid #f1c40f;
      border-radius: 15px;
      padding: 20px;
      box-shadow: inset 0 0 15px rgba(0,0,0,0.5), 0 10px 20px rgba(0,0,0,0.5);
    }

    #reels-container {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      grid-template-rows: repeat(3, 1fr);
      gap: 10px;
      background: #ffffff;
      padding: 10px;
      border-radius: 5px;
      border: 3px solid #7f8c8d;
    }

    .symbol {
      font-size: 3em;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #ecf0f1;
      border-radius: 5px;
      min-height: 80px;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
      transition: transform 0.1s ease-out;
    }
    .symbol.spinning {
      opacity: 0.6;
      filter: blur(2px);
      transform: scale(0.9);
    }

    #bet-controls {
      text-align: center;
      margin-top: 20px;
      margin-bottom: 10px;
      font-family: Arial, sans-serif;
    }
    #bet-controls button {
      font-size: 1.5em;
      font-weight: bold;
      width: 45px;
      height: 45px;
      border-radius: 50%;
      border: 2px solid #007bff;
      background-color: white;
      color: #007bff;
      cursor: pointer;
      transition: background-color 0.2s, color 0.2s;
      vertical-align: middle;
    }
    #bet-controls button:hover { background-color: #007bff; color: white; }
    #bet-controls button:disabled { background-color: #ccc; color: #888; border-color: #ccc; cursor: not-allowed; }
    #bet-input {
      font-size: 1.8em;
      font-weight: bold;
      width: 100px;
      text-align: center;
      margin: 0 15px;
      border: 2px solid #ccc;
      border-radius: 8px;
      vertical-align: middle;
      -moz-appearance: textfield;
    }
    #bet-input::-webkit-outer-spin-button,
    #bet-input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }

    #result-display {
      text-align: center;
      font-family: Arial, sans-serif;
      font-size: 1.8em;
      font-weight: bold;
      margin-top: 20px;
      padding: 15px;
      color: #333;
      transition: color 0.3s, transform 0.3s;
    }
    #result-display.win { color: #2ecc71; transform: scale(1.1); }
    #result-display.lose { color: #95a5a6; }
    #result-display.jackpot { color: #f1c40f; transform: scale(1.2); font-size: 2.2em; }

    #test-log {
      margin: 20px auto;
      max-width: 600px;
      padding: 10px;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 5px;
      display: none;
      font-family: Arial, sans-serif;
    }

    .modal-overlay {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0, 0, 0, 0.6);
      z-index: 2000;
      justify-content: center;
      align-items: center;
      font-family: Arial, sans-serif;
    }
    .modal-content {
      background-color: #fff;
      padding: 20px 30px;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
      width: 90%;
      max-width: 500px;
      position: relative;
      color: #333;
    }
    .modal-close {
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 2.2em;
      font-weight: bold;
      color: #aaa;
      cursor: pointer;
      line-height: 1;
    }
    .modal-close:hover { color: #333; }

    body { height: 200vh; margin: 0; background-color: #f4f4f9; }

    #back-button {
      position: fixed;
      top: 20px;
      left: 20px;
      padding: 10px 20px;
      background: linear-gradient(135deg, #3498db, #2980b9);
      color: white;
      font-size: 1em;
      font-weight: bold;
      text-decoration: none;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      transition: transform 0.2s, box-shadow 0.2s, background 0.3s;
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }
    #back-button:hover {
      background: linear-gradient(135deg, #2980b9, #3498db);
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.35);
    }
  </style>
</head>
<body>

  <div id="balance-container">
    üí∞ Solde : <span id="balance-display">0.00</span> ‚Ç¨
    <button id="recharge-button" onclick="rechargeBalance()">Recharger (100 ‚Ç¨)</button>
    <button id="rules-button" onclick="showRules()">‚ÑπÔ∏è R√®gles</button>
    <button id="cheat-button" onclick="activateCheatMode()">Admin</button>
    <button id="test-button" onclick="runTests()">Test</button>
  </div>

  <a id="back-button" href="Index.html">‚¨Ö Retour</a>

  <div id="slot-container">
    <div id="reels-container">
      <div class="symbol" id="symbol-0-0">üçí</div>
      <div class="symbol" id="symbol-1-0">üçí</div>
      <div class="symbol" id="symbol-2-0">üçí</div>
      <div class="symbol" id="symbol-3-0">üçí</div>
      <div class="symbol" id="symbol-4-0">üçí</div>
      <div class="symbol" id="symbol-0-1">7</div>
      <div class="symbol" id="symbol-1-1">7</div>
      <div class="symbol" id="symbol-2-1">7</div>
      <div class="symbol" id="symbol-3-1">7</div>
      <div class="symbol" id="symbol-4-1">7</div>
      <div class="symbol" id="symbol-0-2">BAR</div>
      <div class="symbol" id="symbol-1-2">BAR</div>
      <div class="symbol" id="symbol-2-2">BAR</div>
      <div class="symbol" id="symbol-3-2">BAR</div>
      <div class="symbol" id="symbol-4-2">BAR</div>
    </div>
  </div>

  <div id="bet-controls">
    <button id="decrease-bet">-</button>
    <input type="number" id="bet-input" value="5.00" min="1.00" max="25.00" step="1.00">
    <button id="increase-bet">+</button>
  </div>

  <div id="result-display">Cliquez sur SPIN pour jouer !</div>

  <button id="spin-button" onclick="startSpin()">SPIN</button>

  <div id="test-log">
    <strong>R√©sultats des tests :</strong>
    <ul id="test-results"></ul>
  </div>

  <div id="rules-modal" class="modal-overlay">
    <div class="modal-content">
      <span class="modal-close" onclick="hideRules()">&times;</span>
      <h2>R√®gles du Jeu</h2>
      <p>Alignez 5 symboles identiques sur la ligne du milieu pour gagner le montant de votre mise multipli√© par la valeur du symbole.</p>
      <h3>Multiplicateurs de Gains :</h3>
      <ul id="payout-list"></ul>
    </div>
  </div>

  <script>
    const MAX_BALANCE = 100.00;
    const MIN_BET = 1.00, MAX_BET = 25.00, BET_STEP = 1.00, DEFAULT_BET = 5.00;
    const SYMBOLS = ["üçí","üçí","üçí","üçí","üçí","üçí","üçã","üçã","üçã","üçã","üçã","üçä","üçä","üçä","üçä","üîî","üîî","üîî","BAR","BAR","7"];
    const PAYOUTS = { "üçí":10, "üçã":20, "üçä":40, "üîî":100, "BAR":500, "7":5000 };

    let userBalance = MAX_BALANCE;
    let currentBet = DEFAULT_BET;
    let isCheatModeActive = false;
    let animationInterval;

    const balanceDisplay = document.getElementById('balance-display');
    const spinButton = document.getElementById('spin-button');
    const resultDisplay = document.getElementById('result-display');
    const betInput = document.getElementById('bet-input');
    const decreaseBetButton = document.getElementById('decrease-bet');
    const increaseBetButton = document.getElementById('increase-bet');
    const testButton = document.getElementById('test-button');
    const rulesModal = document.getElementById('rules-modal');
    const payoutList = document.getElementById('payout-list');

    function showRules() {
      payoutList.innerHTML = '';
      const sorted = Object.entries(PAYOUTS).sort(([,a],[,b])=>a-b);
      for (const [symb, mult] of sorted) {
        const li = document.createElement('li');
        li.innerHTML = `<span>${symb}</span> x5 = <strong>${mult}x</strong>`;
        payoutList.appendChild(li);
      }
      rulesModal.style.display = 'flex';
    }
    function hideRules() { rulesModal.style.display = 'none'; }
    rulesModal.addEventListener('click', e=>{ if(e.target===rulesModal) hideRules(); });

    function activateCheatMode() {
      const cheatBtn = document.getElementById('cheat-button');
      if (isCheatModeActive) {
        isCheatModeActive = false;
        cheatBtn.textContent = translations[getCurrentLang()].adminBtn;
        cheatBtn.style.backgroundColor = "#888";
        testButton.style.display = "none";
        document.getElementById('test-log').style.display = "none";
        alert("Mode Jackpot d√©sactiv√©.");
        return;
      }
      const password = prompt("Entrez le mot de passe administrateur :");
      if (password === "938-555-0100") {
        isCheatModeActive = true;
        cheatBtn.textContent = "CHEAT ON";
        cheatBtn.style.backgroundColor = "#2ecc71";
        testButton.style.display = "inline-block";
        alert("Mode Jackpot activ√© !");
      } else if (password) alert("Mot de passe incorrect.");
    }

    function updateBet(newBet){ if(newBet<MIN_BET)newBet=MIN_BET; if(newBet>MAX_BET)newBet=MAX_BET; currentBet=newBet; betInput.value=Math.round(currentBet); decreaseBetButton.disabled=(currentBet<=MIN_BET); increaseBetButton.disabled=(currentBet>=MAX_BET);}
    function changeBet(a){updateBet(currentBet+a);}
    decreaseBetButton.addEventListener('click',()=>changeBet(-BET_STEP));
    increaseBetButton.addEventListener('click',()=>changeBet(BET_STEP));
    betInput.addEventListener('change',()=>{let v=parseFloat(betInput.value);if(isNaN(v))v=DEFAULT_BET;v=Math.round(v/BET_STEP)*BET_STEP;updateBet(v);});

    function updateBalanceDisplay(){ balanceDisplay.textContent=userBalance.toFixed(2); }
    function adjustBalance(a){
      userBalance+=a;
      if(userBalance<0)userBalance=0;
      updateBalanceDisplay();
      updateBet(currentBet);
      const t = translations[getCurrentLang()];
      if(userBalance<=0){ resultDisplay.textContent=t.outOfBalance; resultDisplay.classList.add('lose'); }
    }
    function rechargeBalance(){
      const t = translations[getCurrentLang()];
      if(userBalance<=0){ userBalance=MAX_BALANCE; resultDisplay.textContent=t.recharged; resultDisplay.classList.add('win'); }
      else { resultDisplay.textContent=`${t.stillHave} ${userBalance.toFixed(2)} ‚Ç¨.`; resultDisplay.classList.remove('win','lose','jackpot'); }
      updateBalanceDisplay(); updateBet(currentBet);
    }

    function getRandomSymbol(){ return SYMBOLS[Math.floor(Math.random()*SYMBOLS.length)]; }
    function generateFinalGrid(){ let g=[]; for(let r=0;r<3;r++){ let row=[]; for(let c=0;c<5;c++){ row.push(isCheatModeActive&&r===1?"7":getRandomSymbol()); } g.push(row);} return g; }

    function runSpinAnimation(cols){ for(const c of cols) for(let r=0;r<3;r++) document.getElementById(`symbol-${c}-${r}`).textContent=getRandomSymbol(); }
    function stopColumn(i,grid,cols){ const x=cols.indexOf(i); if(x>-1)cols.splice(x,1); for(let r=0;r<3;r++){ const s=document.getElementById(`symbol-${i}-${r}`); s.textContent=grid[r][i]; s.classList.remove('spinning'); } }

    function startSpin(){
      const t = translations[getCurrentLang()];
      if(userBalance<currentBet){ resultDisplay.textContent=t.insufficient; resultDisplay.classList.add('lose'); return; }
      spinButton.disabled=true; decreaseBetButton.disabled=true; increaseBetButton.disabled=true; betInput.disabled=true;
      adjustBalance(-currentBet);
      resultDisplay.textContent=t.spinningMsg; resultDisplay.classList.remove('win','lose','jackpot');
      const grid=generateFinalGrid(); let cols=[0,1,2,3,4];
      document.querySelectorAll('.symbol').forEach(s=>s.classList.add('spinning'));
      animationInterval=setInterval(()=>runSpinAnimation(cols),100);
      setTimeout(()=>stopColumn(0,grid,cols),1000);
      setTimeout(()=>stopColumn(1,grid,cols),1500);
      setTimeout(()=>stopColumn(2,grid,cols),2000);
      setTimeout(()=>stopColumn(3,grid,cols),2500);
      setTimeout(()=>{
        stopColumn(4,grid,cols);
        clearInterval(animationInterval);
        let winnings=0; const row=grid[1];
        if(row.every(s=>s===row[0])){ winnings=currentBet*PAYOUTS[row[0]]; }
        if(winnings>0){
          adjustBalance(winnings);
          if(row[0]==="7"){ resultDisplay.textContent=t.jackpotMsg(winnings); resultDisplay.classList.add('jackpot'); }
          else { resultDisplay.textContent=t.winMsg(winnings); resultDisplay.classList.add('win'); }
        } else { resultDisplay.textContent=t.loseMsg; resultDisplay.classList.add('lose'); }
        spinButton.disabled=false; betInput.disabled=false; updateBet(currentBet);
      },3000);
    }

    function assert(desc, cond){ const li=document.createElement('li'); li.textContent=desc+' ‚Üí '+(cond?'‚úÖ OK':'‚ùå √âchec'); li.style.color=cond?'green':'red'; document.getElementById('test-results').appendChild(li);}
    function runTests(){ const log=document.getElementById('test-log'); log.style.display='block'; document.getElementById('test-results').innerHTML=''; assert('Solde initial', userBalance===MAX_BALANCE); assert('Mise', currentBet===DEFAULT_BET); assert('SPIN activ√©', !spinButton.disabled); if(!isCheatModeActive)activateCheatMode(); const g=generateFinalGrid(); assert('Cheat = 77777', g[1].every(s=>'7'===s)); }

    // ==== Langue synchronis√©e ====
    const LS_LANG_KEY='lang';
    const translations={
      fr:{
        balanceLabel:"üí∞ Solde : ",
        rechargeBtn:"Recharger (100 ‚Ç¨)",
        rulesBtn:"‚ÑπÔ∏è R√®gles",
        adminBtn:"Admin",
        backBtn:"‚¨Ö Retour",
        spinBtn:"SPIN",
        startMsg:"Cliquez sur SPIN pour jouer !",
        spinningMsg:"Les rouleaux tournent...",
        insufficient:"Solde insuffisant !",
        outOfBalance:"Solde √©puis√© ! Veuillez recharger.",
        recharged:"Solde recharg√© !",
        stillHave:"Vous avez encore",
        winMsg:v=>`Bravo ! Vous gagnez ${v.toFixed(2)} ‚Ç¨ !`,
        loseMsg:"Pas de chance... Essayez encore !",
        jackpotMsg:v=>`üéâ JACKPOT !!! +${v.toFixed(2)} ‚Ç¨ !`,
        rulesTitle:"R√®gles du Jeu",
        rulesDesc:"Alignez 5 symboles identiques sur la ligne du milieu pour gagner le montant de votre mise multipli√© par la valeur du symbole.",
        payoutTitle:"Multiplicateurs de Gains :"
      },
      en:{
        balanceLabel:"üí∞ Balance: ",
        rechargeBtn:"Recharge (‚Ç¨100)",
        rulesBtn:"‚ÑπÔ∏è Rules",
        adminBtn:"Admin",
        backBtn:"‚¨Ö Back",
        spinBtn:"SPIN",
        startMsg:"Click SPIN to play!",
        spinningMsg:"The reels are spinning...",
        insufficient:"Insufficient balance!",
        outOfBalance:"Balance empty! Please recharge.",
        recharged:"Balance recharged!",
        stillHave:"You still have",
        winMsg:v=>`Congrats! You win ${v.toFixed(2)} ‚Ç¨!`,
        loseMsg:"No luck... Try again!",
        jackpotMsg:v=>`üéâ JACKPOT!!! +${v.toFixed(2)} ‚Ç¨!`,
        rulesTitle:"Game Rules",
        rulesDesc:"Align 5 identical symbols on the middle line to win your bet multiplied by the symbol's value.",
        payoutTitle:"Winning Multipliers:"
      }
    };
    function getCurrentLang(){return localStorage.getItem(LS_LANG_KEY)||'fr';}
    function applyTranslations(){
      const lang=getCurrentLang(),t=translations[lang];
      document.documentElement.lang=lang;
      document.querySelector('#balance-container').childNodes[0].textContent=t.balanceLabel;
      document.getElementById('recharge-button').textContent=t.rechargeBtn;
      document.getElementById('rules-button').textContent=t.rulesBtn;
      document.getElementById('cheat-button').textContent=t.adminBtn;
      document.getElementById('back-button').textContent=t.backBtn;
      document.getElementById('spin-button').textContent=t.spinBtn;
      document.getElementById('result-display').textContent=t.startMsg;
      document.querySelector('#rules-modal h2').textContent=t.rulesTitle;
      document.querySelector('#rules-modal p').textContent=t.rulesDesc;
      document.querySelector('#rules-modal h3').textContent=t.payoutTitle;
    }
    applyTranslations();
    updateBalanceDisplay(); updateBet(currentBet);
  </script>
</body>
</html>
