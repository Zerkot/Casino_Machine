<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Test automatique — Interface 2 images + zone cliquable</title>
  <style>
    body { font-family: sans-serif; background: #f0f4fa; color: #111; padding: 20px; }
    .test-log { background: #fff; border: 1px solid #ccc; padding: 12px; margin-top: 20px; border-radius: 6px; }
    .pass { color: green; }
    .fail { color: red; }
    .click-area { border: 2px dashed #334; padding: 20px; margin-top: 16px; cursor: pointer; background: #eef; border-radius: 8px; }
    .pulse { animation: pulse 0.4s ease; }
    @keyframes pulse { 0% {transform: scale(1);} 50% {transform: scale(1.05);} 100% {transform: scale(1);} }
    .btn { padding: 6px 12px; background: #334; color: white; border: none; border-radius: 4px; cursor: pointer; }
    .btn:hover { background: #446; }
  </style>
</head>
<body>
  <h1>Interface — test intégrée</h1>

  <div class="top-row">
    <div class="dropzone" id="dz1">
      <img class="preview" src="secondary-thumb2x.jpg" alt="Image fixe 1">
    </div>

    <div class="dropzone" id="dz2">
      <img class="preview" src="roulette-francaise-300x300.jpg" alt="Image fixe 2">
    </div>
  </div>

  <div class="click-area" id="clickArea" tabindex="0">
    <div class="click-inner">
      <div class="click-title">Zone cliquable</div>
      <div class="click-sub">Clique ici — action configurable</div>
      <button class="btn" id="actionBtn">Action par défaut</button>
    </div>
  </div>

  <div class="test-log" id="testLog">
    <strong>Résultats des tests :</strong>
    <ul id="results"></ul>
  </div>

  <script>
    const clickArea = document.getElementById('clickArea');
    const actionBtn = document.getElementById('actionBtn');

    function onClickAction(){
      clickArea.classList.remove('pulse');
      void clickArea.offsetWidth;
      clickArea.classList.add('pulse');
      showOverlay('Zone cliquée !');
    }

    clickArea.addEventListener('click', onClickAction);
    clickArea.addEventListener('keydown', e => { if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); onClickAction(); } });
    actionBtn.addEventListener('click', e => { e.stopPropagation(); onClickAction(); });

    function showOverlay(text){
      const overlay = document.createElement('div');
      overlay.id = 'overlay';
      overlay.style.position = 'fixed';
      overlay.style.inset = '0';
      overlay.style.display = 'flex';
      overlay.style.alignItems = 'center';
      overlay.style.justifyContent = 'center';
      overlay.style.background = 'rgba(2,6,23,0.6)';
      overlay.style.zIndex = 9999;

      const card = document.createElement('div');
      card.style.background = '#07132a';
      card.style.padding = '20px';
      card.style.borderRadius = '12px';
      card.style.maxWidth = '90%';
      card.style.color = '#e6eef8';
      card.style.textAlign = 'center';

      const p = document.createElement('pre');
      p.textContent = text;
      const ok = document.createElement('button');
      ok.textContent = 'Fermer';
      ok.className = 'btn';
      ok.addEventListener('click', () => overlay.remove());

      card.appendChild(p);
      card.appendChild(ok);
      overlay.appendChild(card);
      document.body.appendChild(overlay);
    }

    // -------- Tests automatiques intégrés --------
    const results = document.getElementById('results');
    function assert(desc, condition) {
      const li = document.createElement('li');
      li.textContent = desc + ' → ' + (condition ? '✅ OK' : '❌ Échec');
      li.className = condition ? 'pass' : 'fail';
      results.appendChild(li);
    }

    window.addEventListener('load', () => {
      // Test 1 : images visibles
      assert('Image 1 présente', !!document.querySelector('#dz1 img'));
      assert('Image 2 présente', !!document.querySelector('#dz2 img'));

      // Test 2 : clic sur zone cliquable crée un overlay
      clickArea.click();
      setTimeout(() => {
        const overlay = document.getElementById('overlay');
        assert('Overlay affiché après clic', !!overlay);

        // Test 3 : bouton "Fermer" fonctionne
        if (overlay) {
          const closeBtn = overlay.querySelector('button');
          closeBtn.click();
          setTimeout(() => {
            assert('Overlay supprimé après clic sur Fermer', !document.getElementById('overlay'));
          }, 200);
        }
      }, 200);
    });
  </script>
</body>
</html>
